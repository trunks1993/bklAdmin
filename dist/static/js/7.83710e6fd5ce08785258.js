webpackJsonp([7],{"2Kjj":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-table__expanded-cell {\n  background: #fafbf9;\n}\n.el-table__expanded-cell:hover {\n    background-color: #fafbf9 !important;\n}\n",""])},"9yiF":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.activity-dialog[data-v-1b29d355] {\n  padding: 0 20px 20px 20px;\n}\n",""])},POU1:function(t,e,a){var i=a("9yiF");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("9341cf14",i,!0)},bu1J:function(t,e,a){var i=a("2Kjj");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("62e9af42",i,!0)},r2fM:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s});var i=function(t){return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{right:"20px",feature:{magicType:{type:["line","bar"]}}},legend:{data:t.dataNames},grid:{left:0,right:0,bottom:0,containLabel:!0},xAxis:[{type:"category",data:t.xAxis}],yAxis:[{type:"value"}],series:[{name:t.values[0].name,type:"bar",data:t.values[0].data},{name:t.values[1].name,type:"bar",data:t.values[1].data},{name:t.values[2].name,type:"bar",data:t.values[2].data}]}},n=function(t){return{title:{text:"朋友圈点击量",subtext:"按时间段",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:t.legendData},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:t.data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},s=function(t){return{title:{text:"扫码量",subtext:"按时间段",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:t.legendData},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:t.data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}},sZNU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("//Fk"),n=a.n(i),s=a("Ty/O"),l=a("r2fM"),o=a("cAgV"),r=(a("E4LH"),a("jYru")),c={directives:{waves:o.a},components:{AdvertSelect:r.a},data:function(){return{loading:!1,total:NaN,listQuery:{current:1,size:20,condition:{name:"",status:"",user:this.$store.getters.userInfo.id}},activity:[],dialogActivity:!1,selectedActivity:null,dateType:1,uploadUrl:"https://www.ijnkj.com/bkl/api/upload/uploadImg/"+this.$store.getters.userInfo.id}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(s.d)(this.listQuery).then(function(e){var a=e.data;0===a.code&&"success"===a.msg&&(t.activity=a.datas.records,t.total=a.datas.total,t.loading=!1)})},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleCreate:function(){this.$router.push({path:"/activity/create"})},handleFilter:function(){this.listQuery.current=1,this.getList()},handlerRadioChange:function(){this.getList()},handleChangeStatus:function(t,e,a){var i=this;Object(s.a)(t,e).then(function(t){var n=t.data;0===n.code&&"success"===n.msg?(i.activity[a].status=n.data,i.$message({type:0===n.data?"success":"warning",message:0===n.data?"已启用":"已停用"})):(i.activity[a].status=e,i.$message.error("操作失败"))})},handleDelete:function(t){var e=this;return new n.a(function(e,a){Object(s.f)(t).then(function(t){var a=t.data;0===a.code&&"success"===a.msg&&e(a.data)})}).then(function(a){e.$confirm("本次活动已使用二维码"+a.scanedCount+"张，金额"+a.scanedMoney/100+"元，删除活动剩余"+a.restCount+"张二维码将会永久失效，未使用金额"+a.restMoney/100+"元将会返回您的账户，是否删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.c)(t).then(function(t){var a=t.data;0===a.code&&"success"===a.msg&&(e.getList(),e.$store.dispatch("GetUserInfo"),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}))})})})},openActivityDialog:function(t){this.dialogActivity=!0,this.selectedActivity=t,this.initStatisticsByActivityId()},selectedAdvert:function(t){this.selectedActivity=_.clone(t)},handleChange:function(){this.initStatisticsByActivityId()},initStatisticsByActivityId:function(){var t=this;Object(s.g)(this.selectedActivity.id,this.dateType).then(function(e){var a=e.data;0===a.code&&"success"===a.msg&&t.$echarts.init(document.getElementById("countData")).setOption(Object(l.c)(a.data.totalData))})},updateActivity:function(t){var e=this;Object(s.h)(t).then(function(t){var a=t.data;0===a.code&&"success"===a.msg&&(e.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),e.getList(),e.dialogActivity=!1)})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"标题"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleFilter(e)}},model:{value:t.listQuery.condition.name,callback:function(e){t.$set(t.listQuery.condition,"name",e)},expression:"listQuery.condition.name"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-search"},nativeOn:{click:function(e){t.handleFilter(e)}}},[t._v("搜索")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("创建活动")]),t._v(" "),a("div",{staticStyle:{margin:"10px 0"}},[a("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:t.handlerRadioChange},model:{value:t.listQuery.condition.status,callback:function(e){t.$set(t.listQuery.condition,"status",e)},expression:"listQuery.condition.status"}},[a("el-radio",{attrs:{label:""}},[t._v("所有活动")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("正进行")]),t._v(" "),a("el-radio",{attrs:{label:3}},[t._v("未开始")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("已停用")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",data:t.activity},on:{"expand-change":t.selectedAdvert}},[a("el-table-column",{attrs:{type:"expand",label:"广告",width:"100px","cell-style":"tableExpand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.selectedActivity?a("div",{staticStyle:{position:"relative"}},[a("advert-select",{model:{value:e.row.advert,callback:function(a){t.$set(e.row,"advert",a)},expression:"scope.row.advert"}}),t._v(" "),a("div",{staticStyle:{position:"absolute",left:"210px",bottom:"0"}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:t.selectedActivity.advert===t.activity[e.$index].advert},on:{click:function(a){t.updateActivity(e.row)}}},[t._v("保存修改")])],1)],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"活动名"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"活动类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("getTypeName")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"startDate",align:"center",label:"开始时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("parseTime")(e.row.startDate,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"活动状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("getActivityStatus")(e.row.status,!0)}},[t._v("\n          "+t._s(t._f("getActivityStatus")(e.row.status,!1))+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.openActivityDialog(e.row)}}},[t._v("详细")]),t._v(" "),1===e.row.status||2===e.row.status?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){t.handleDelete(e.row.id)}}},[t._v("删除")]):t._e(),t._v(" "),a("el-tooltip",{staticStyle:{"margin-left":"10px"},attrs:{content:0==e.row.status?"已开启":"已停用",placement:"top"}},[1===e.row.status||0===e.row.status?a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":0,"inactive-value":1},on:{change:function(a){t.handleChangeStatus(e.row.id,a,e.$index)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}}):t._e()],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.current,"page-size":t.listQuery.size,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"current",e)}}})],1),t._v(" "),t.selectedActivity?a("el-dialog",{staticClass:"activity-dialog",attrs:{title:"活动详情",visible:t.dialogActivity},on:{"update:visible":function(e){t.dialogActivity=e}}},[a("el-row",[a("el-col",{attrs:{span:6}},[t._v("\n        总金额："+t._s(t.selectedActivity.totalMoney/100)+"\n      ")]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("\n        总二维码数："+t._s(t.selectedActivity.qrCount)+"\n      ")]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("\n        已扫描金额："+t._s(t.selectedActivity.scanedMoney/100)+"\n      ")]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("\n        已扫码二维码数："+t._s(t.selectedActivity.scanedCount)+"\n      ")])],1),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("span",[t._v("筛选：")]),t._v(" "),a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.handleChange},model:{value:t.dateType,callback:function(e){t.dateType=e},expression:"dateType"}},[a("el-option",{attrs:{label:"最近一周",value:1}}),t._v(" "),a("el-option",{attrs:{label:"最近一月",value:2}}),t._v(" "),a("el-option",{attrs:{label:"最近一年",value:3}})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"},style:{width:"100%",height:"400px"},attrs:{id:"countData"}})],1)],1):t._e()],1)},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(t){a("POU1"),a("bu1J")},"data-v-1b29d355",null);e.default=u.exports}});